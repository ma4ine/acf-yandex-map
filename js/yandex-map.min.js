!function(r){var o=yandex_locale.plugin_url,s={iconLayout:"default#image",iconImageHref:o+"svg/mark-house-1.svg",iconImageSize:[36,36],iconImageOffset:[-18,-36]},d={fillColor:"#44A147",strokeColor:"#18803F",strokeWidth:2,opacity:.7};ymaps.ready(function(){r(".yandex-map").each(function(o,e){var t=r(e).attr("id");if(void 0!==t&&void 0!==window[t]){var a=r.parseJSON(window[t].params),n=new ymaps.Map(t,{zoom:a.zoom,center:[a.center_lat,a.center_lng]},{});if(n.controls.remove("trafficControl"),n.controls.remove("searchControl"),n.controls.remove("geolocationControl"),null!=a.marks&&r(a.marks).each(function(o,e){var t=null;t="Point"==e.type?new ymaps.Placemark(e.coords,{balloonContent:e.content}):new ymaps.Circle([e.coords,e.circle_size],{balloonContent:e.content},{opacity:.5,fillOpacity:.1,fillColor:"#DB709377",strokeColor:"#990066",strokeOpacity:.7,strokeWidth:5}),n.geoObjects.add(t)}),"ymap_full"===t){$object_manager=new ymaps.ObjectManager({geoObjectOpenBalloonOnClick:!1});var l=Object.assign({},s,d);function c(o,e){var t=ymaps.vow.defer();return r.get({url:yandex_locale.ajax_url,data:{action:"ymap_object_load",nonce_code:yandex_locale.nonce,post_id:e}}).done(function(o){console.log("Object data loaded");var e=function(o){if(!o)return"Ошибка!";var e=r.parseJSON(o);return'<div class="module--header"><div class="module--title"><div class="module--suptitle">'+e.offer_type+"</div>"+e.title+'</div></div><div class="module--body"><div class="module--item icb"><i class="icb--icon icon icon-location"></i><div class="icb--title">'+e.location+'</div></div><div class="module--item module--item-50"><img src="'+e.thumb_url+'" alt="Фото участка" class="module--pic"></div><div class="module--item module--item-50"><div class="common_item"><div class="common_item--title"><em>Площадь</em></div><div class="common_item--value">'+e.square+'</div></div><div class="common_item"><div class="common_item--title"><em>Стоимость</em></div><div class="common_item--value">'+e.price+' ₽</div></div></div></div><div class="module--footer module--footer-center"><a href="'+e.link+'" class="module--but but but-green">Подробнее</a></div>'}(o);t.resolve(e)}).fail(function(){console.error("Object data error"),t.resolve("Ошибка!")}),t.promise()}function i(o){n.geoObjects.add($object_manager);var e=window[t].plugin_url;r.ajax({url:e+"json/"+o+".json"}).done(function(o){$object_manager.add(o),console.log("Map data loaded"),n.setBounds(n.geoObjects.getBounds(),{checkZoomRange:!0})}).fail(function(){console.error("Map data error")})}$object_manager.objects.options.set(l),$object_manager.objects.events.add("click",function(o){var e=o.get("objectId"),t=$object_manager.objects.getById(e),a=t.id;!function(o){return $object_manager.objects.getById(o).properties.balloonContent}(e)?(t.properties.balloonContent="Идет загрузка данных...",$object_manager.objects.balloon.open(e),c(0,a).then(function(o){t.properties.balloonContent=o,$object_manager.objects.balloon.setData(t)})):$object_manager.objects.balloon.open(e)}),r("a.js-map-link").on("click",function(){$object_manager.removeAll(),i("land-vsevolozhsk")}),r("button.js-map-link").on("click",function(){$object_manager.removeAll(),i("land-tajtsy")})}}})})}(jQuery);
//# sourceMappingURL=yandex-map.min.js.map